print((lambda g,r,l:(r(lambda f,x,l:x[-1]in l and sum(int(i[0])*(1+f(f,x+[i[2:]],l))for i in l[x[-1]]if i[2:]not in x),[g],l), r(lambda f,x,l:not x and sum(f(f,[i],l)for i in l)-1or(g in x or x[-1]in l and max(f(f,x+[i[2:]],l)for i in l[x[-1]]if i[2:]not in x)),[],l)))('shiny gold',lambda f,x,l:f(f,x,l),{a:b for a,*b in[[k[:-4].strip()for k in i[:-2].replace(' contain',',').split(',')]for i in open('input.txt')if not "th" in i]}))