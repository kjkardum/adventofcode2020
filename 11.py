print((lambda l,E:["".join((lambda f,*a:f(f,*a))(lambda r,l,t,g:(lambda q:l if l==q else r(r,q[:],t,g))(["".join([m*(m=='.')+(lambda z:('L'if z else'#')*(m=='L')+('L'if z>t else'#')*(m=='#'))(sum((lambda f,*a:f(f,*a))(lambda z,d:(1if l[i+k[0]*d][j+k[1]*d]=="#"else z(z,d+1))if 0<=i+k[0]*d<len(l)and 0<=j+k[1]*d<len(l[i+k[0]*d])and d<g and l[i+k[0]*d][j+k[1]*d]!="L"else 0,1)for k in[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]]))for j,m in E(k)])for i,k in E(l)]),*v)).count('#')for v in[(l,3,2),(l,4,99)]])([(i.strip())for i in open('input.txt')],enumerate))