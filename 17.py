print((lambda moves,l,g,Σ:(lambda t:(Σ(Σ(j.count('#')for j in i)for i in t[0]),Σ(Σ(Σ(k.count('#')for k in j)for j in i)for i in t[1])))([(lambda f,*a:f(f,*a))(lambda T,t,l,n,d:l if t==6 else[(lambda f,*a:f(f,*a))(lambda D,i,k,n,d,m:[n.append((lambda z:'#'if h=='#'and z==2or z==3else'.')((lambda l,i,ii,iii,iiii=0,d=1:Σ([1for x in([i[1:]for i in moves if i[0]==0]if d else moves)if 0<=i+x[0]<len(l)and 0<=ii+x[1]<len(l[i+x[0]])and 0<=iii+x[2]<len(l[i+x[0]][ii+x[1]])and(d or 0<=iiii+x[3]<len(g[i+x[0]][ii+x[1]][iii+x[2]]))and(d and l[i+x[0]][ii+x[1]][iii+x[2]]=='#'or(not d)and l[i+x[0]][ii+x[1]][iii+x[2]][iiii+x[3]]=='#')]))(k[0],*i,j,m<3)))for j,h in enumerate(k[-1])]if d==m else[[n.append([]),D(D,i+[j],k+[h],n[-1],d+1,m)]for j,h in enumerate(k[-1])],[],[l],n,0,d),T(T,t+1,n,[],d)][1],*a)for a in[[0,l,[],2],[0,g,[],3]]]))(*(lambda a:[[[h,i,j,k]for i in[-1,0,1]for j in[-1,0,1]for k in[-1,0,1]for h in[-1,0,1]if[i,j,k,h]!=[0,0,0,0]],a[0],[[[k[:]for k in j]for j in i]for i in [a[1]]*6+[a[0]]*1+[a[1]]*6]])((lambda s:[[j[:]for j in i]for i in(lambda e:([e]*6+[s]*1+[e]*6,[e]*13))([list("."*len(s[0]))]*6+[list("."*(13+len(s)))for i in s]+[list("."*len(s[0]))]*6)])((lambda r:[list("."*len(r[0]))]*6+r+[list("."*len(r[0]))]*6)([list("."*6)+list(i.strip())+list("."*6)for i in open('input.txt')]))),sum))